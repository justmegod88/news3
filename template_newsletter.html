<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily News Monitoring</title>
  <style>
    /* ✅ Outlook-safe 기본 폰트: Arial 우선 */
    body {
      margin:0; padding:0;
      background:#ffffff;
      font-family: Arial, "Malgun Gothic", "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
      -webkit-text-size-adjust:100%;
      -ms-text-size-adjust:100%;
    }

    /* ✅ 모바일은 원래대로, PC/Outlook은 아래 MSO 래퍼가 책임짐 */
    .container {
      max-width:640px;
      margin:0 auto;
      padding:16px;
      box-sizing:border-box;
    }

    h1 { margin:0; color:#003f7f; font-size:22px; }
    h2 { margin:22px 0 8px 0; color:#003f7f; font-size:16px; }

    /* ✅ 요청 2) 하늘색 영역(요약/전체기사 영역) 세로 사이즈 줄임 */
    .summary {
      background:#eaf3ff;
      padding:8px 12px;               /* ⬅ 기존보다 얇게 */
      border-left:4px solid #003f7f;
      margin:14px 0 18px 0;
      font-size:13px;
      line-height:18px;               /* ⬅ Outlook 안정 라인하이트 */
      mso-line-height-rule: exactly;  /* ⬅ Outlook */
    }

    /* ✅ 테이블 공통 */
    table.news-table {
      width:100%;
      border-collapse:collapse;
      table-layout:fixed;             /* ⬅ 컬럼폭 고정 핵심 */
      margin-top:6px;
      margin-bottom:22px;
    }

    /* ✅ 요청 3) 표 워딩 세로 중앙(상하 중앙) */
    table.news-table th,
    table.news-table td {
      padding:10px 8px;
      font-size:12px;
      vertical-align:middle;          /* ⬅ 세로 중앙 */
      mso-line-height-rule: exactly;  /* ⬅ Outlook */
      line-height:16px;
      word-break:break-word;
      overflow-wrap:break-word;
    }

    table.news-table th {
      background:#f3f7ff;
      text-align:left;
      border-bottom:1px solid #dde3f5;
      font-weight:700;
    }

    table.news-table td {
      border-top:1px solid #eee;
    }

    table.news-table tr:nth-child(even) td {
      background:#fafafa;
    }

    /* ✅ 요청 4) 카테고리별 테이블 가로 사이즈/컬럼폭 고정 */
    .col-title  { width:30%; }
    .col-press  { width:16%; }
    .col-sum    { width:40%; }
    .col-link   { width:14%; }

    a { color:#0066cc; text-decoration:none; }
    a:hover { text-decoration:underline; }

    .footer {
      text-align:center;
      font-size:11px;
      color:#777;
      margin-top:24px;
    }

    /* 로고 */
    img.logo {
      width:70px;
      height:70px;
      object-fit:contain;
      border-radius:8px;
      display:block;
    }

    @media only screen and (max-width: 480px) {
      .container { padding:12px; }
    }
  </style>
</head>
<body>

  <!-- ✅ OUTLOOK(PC) 폭 고정 래퍼: max-width 무시 문제 해결 -->
  <!--[if mso]>
  <table role="presentation" width="640" align="center" cellpadding="0" cellspacing="0" border="0">
    <tr>
      <td style="padding:16px;">
  <![endif]-->

  <div class="container">

    <!-- 헤더(테이블 기반) + 로고 CID -->
    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:14px;">
      <tr>
        <td align="left" valign="middle" style="padding:0;">
          <div style="font-size:24px; font-weight:700; color:#245caa; margin:0 0 2px 0; line-height:28px; mso-line-height-rule:exactly;">
            Daily News Monitoring
          </div>
          <div style="font-size:11px; color:#555; line-height:14px; mso-line-height-rule:exactly;">
            {{ today }}
          </div>
        </td>
        <td align="right" valign="middle" style="padding:0;">
          <!-- ✅ 요청: 로고 “아예 박기” (CID) -->
          <img class="logo" src="cid:acuvue_logo" alt="ACUVUE" />
        </td>
      </tr>
    </table>

    <!-- 요약/전체기사 하늘색 영역 -->
    <div class="summary">
      <div style="font-weight:700; margin-bottom:4px;">어제 기사 요약</div>
      <div>{{ overall_summary }}</div>
    </div>

    <!-- 1) 아큐브 헤드라인 -->
    <div style="margin:0 0 0 0; padding-top:10px; border-top:1px solid #eeeeee;">
      <div style="font-size:13px; font-weight:700; color:#333; margin-bottom:2px;">
        1) 아큐브 헤드라인
      </div>

      <table class="news-table">
        <colgroup>
          <col class="col-title" width="30%">
          <col class="col-press" width="16%">
          <col class="col-sum"   width="40%">
          <col class="col-link"  width="14%">
        </colgroup>
        <tr>
          <th>제목</th>
          <th>언론사</th>
          <th>요약</th>
          <th>링크</th>
        </tr>
        {% for a in acuvue_headline_articles %}
        <tr>
          <td>{{ a.title }}</td>
          <td>{{ a.source }}</td>
          <td>{{ a.summary }}</td>
          <td><a href="{{ a.link }}" target="_blank">보기</a></td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <!-- 2) 회사/경쟁사 -->
    <div style="margin:0 0 0 0; padding-top:10px; border-top:1px solid #eeeeee;">
      <div style="font-size:13px; font-weight:700; color:#333; margin-bottom:2px;">
        2) 회사/경쟁사 (알콘/쿠퍼/바슈롬/기타)
      </div>

      <table class="news-table">
        <colgroup>
          <col class="col-title" width="30%">
          <col class="col-press" width="16%">
          <col class="col-sum"   width="40%">
          <col class="col-link"  width="14%">
        </colgroup>
        <tr>
          <th>제목</th>
          <th>언론사</th>
          <th>요약</th>
          <th>링크</th>
        </tr>
        {% for a in company_articles %}
        <tr>
          <td>{{ a.title }}</td>
          <td>{{ a.source }}</td>
          <td>{{ a.summary }}</td>
          <td><a href="{{ a.link }}" target="_blank">보기</a></td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <!-- 3) 업계 동향 -->
    <div style="margin:0 0 0 0; padding-top:10px; border-top:1px solid #eeeeee;">
      <div style="font-size:13px; font-weight:700; color:#333; margin-bottom:2px;">
        3) 업계 동향 (협회/컨퍼런스/체인/안경 등)
      </div>

      <table class="news-table">
        <colgroup>
          <col class="col-title" width="30%">
          <col class="col-press" width="16%">
          <col class="col-sum"   width="40%">
          <col class="col-link"  width="14%">
        </colgroup>
        <tr>
          <th>제목</th>
          <th>언론사</th>
          <th>요약</th>
          <th>링크</th>
        </tr>
        {% for a in trend_articles %}
        <tr>
          <td>{{ a.title }}</td>
          <td>{{ a.source }}</td>
          <td>{{ a.summary }}</td>
          <td><a href="{{ a.link }}" target="_blank">보기</a></td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <!-- 4) 눈 건강 -->
    <div style="margin:0 0 0 0; padding-top:10px; border-top:1px solid #eeeeee;">
      <div style="font-size:13px; font-weight:700; color:#333; margin-bottom:2px;">
        4) 눈 건강 · 캠페인
      </div>

      <table class="news-table">
        <colgroup>
          <col class="col-title" width="30%">
          <col class="col-press" width="16%">
          <col class="col-sum"   width="40%">
          <col class="col-link"  width="14%">
        </colgroup>
        <tr>
          <th>제목</th>
          <th>언론사</th>
          <th>요약</th>
          <th>링크</th>
        </tr>
        {% for a in eye_health_articles %}
        <tr>
          <td>{{ a.title }}</td>
          <td>{{ a.source }}</td>
          <td>{{ a.summary }}</td>
          <td><a href="{{ a.link }}" target="_blank">보기</a></td>
        </tr>
        {% endfor %}
      </table>
    </div>

    <div class="footer">
      이 뉴스레터는 자동 생성되었습니다.
    </div>

  </div>

  <!--[if mso]>
      </td>
    </tr>
  </table>
  <![endif]-->

</body>
</html>
